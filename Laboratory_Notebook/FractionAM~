#!/usr/bin/env python3

"""
FractionAM converts atom fractions to mass fractions
and mass fractions to atom fractions. Input is a 
single string with MCNP style fractions.
"""

__author__     =  "Paul Mendoza"
__copyright__  =  "Copyright 2016, Planet Earth"
__credits__    = ["Sunil Chirayath",
                  "Charles Folden",
                  "Jeremy Conlin"]
__license__    =  "GPL"
__version__    =  "1.0.1"
__maintainer__ =  "Paul Mendoza"
__email__      =  "paul.m.mendoza@gmail.com"
__status__     =  "Production"

################################################################
##################### Import packages ##########################
################################################################

import os.path
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import datetime
from uncertainties import ufloat
from uncertainties.umath import *
from uncertainties import unumpy as unp

################################################################
########################## Input ###############################
################################################################

#ZAID fraction Error
string='92235 0.285714286 0 92238 0.714285714 0'
#string='92235 0.288310115 0 92238 0.711689885 0' #False

MasstoAtom=True

################################################################
####################### Gather Data ############################
################################################################

ListOfString=string.split()

if not len(ListOfString)%3==0:
    print("Check string variable missing fraction or error")
    quit()

#Initialize fractions and zaid
Zaid=0*np.arange(0,int(len(ListOfString)/3))

#Gather fraction data and zaid data
for i in range(0,int(len(ListOfString)/3)):
    Zaid[i]=int(ListOfString[i*3])


df = pd.read_csv('AtomicWeights.csv')
#Gather Mass Data
for i in range(0,len(Zaid)):
    sZaid=str(Zaid[i])
    if len(sZaid)==4:
        proton=sZaid[0:2]
        if sZaid[2]=="0":
            Isotope=sZaid[3]
        else:
            Isotope=sZaid[2:4]
    elif len(sZaid)==5:
        proton=sZaid[0:2]
        if sZaid[2]=="0":
            Isotope=sZaid[3:5]
        if sZaid[3]=="0":
            Isotope=sZaid[4:5]
        if sZaid[2]!="0" and sZaid[3]!="0":
            Isotope=sZaid[2:5]
    elif len(sZaid)==6:
        proton=sZaid[0:3]
        Isotope=sZaid[3:6]
    else:
        print("Length of zaid is not 4 5 or 6 err")
        quit()
    

print(proton)
print(Isotope)
for i in range(0,len(df.Protons)):
    dfPro=str(df.Protons[i])
    if proton[0]==dfPro or proton==dfPro:
        for j in range(0,len(df.Isotope)):
            dfIso=str(df.Isotope[j])
            if Isotope==dfIso and i==j:
                print("Hello")
                print(df.Protons[i])
                print(df.Isotope[j])
                print(df.
                quit()
Mass=np.array([ufloat(235,1),ufloat(238,1)])

#print(df)

quit()
################################################################
###################### Calculation #############################
################################################################

Total=ufloat(0.,0)

for i in range(0,len(Zaid)):

    Fraction=ufloat(float(ListOfString[i*3+1]),float(ListOfString[i*3+2]))
    if MasstoAtom: #Calculate total Atoms
        Total=Total+Fraction/Mass[i]
    else: #Calculate total Mass
        Total=Total+Fraction*Mass[i]

stringCalculated=''
for i in range(0,len(Zaid)):

    Fraction=ufloat(float(ListOfString[i*3+1]),float(ListOfString[i*3+2]))
    if MasstoAtom:
        #Calculate atom fractions
        FractionCalculated=(Fraction/Mass[i])/Total
    else:
        #Calculate mass fractions
        FractionCalculated=(Fraction*Mass[i])/Total
        
    stringCalculated=stringCalculated+\
                      str(Zaid[i])+' '+\
                      str(FractionCalculated)+' '

if MasstoAtom:
    print("Mass Fractions:")
    print(string)
    print("Atom Fractions:")
    print(stringCalculated)
else:
    print("Mass Fractions:")
    print(stringCalculated)
    print("Atom Fractions:")
    print(string)
